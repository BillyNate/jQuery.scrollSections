/*! jQuery ScrollSections (minified)
* @version 0.3.0
* @link https://github.com/guins/jquery-scrollsections
* @author Stéphane Guigné <http://stephaneguigne.com/>
* @author Richard Fussenegger <http://richard.fussenegger.info/>
* @license MIT
* @copyright (c) 2011-2013, Stéphane Guigné
*/
!function(a,b,c){"use strict";function d(a){this.name="ScrollSectionsException",this.message=a}function e(c,d){this.elements=c,this.options=a.extend({},g,d),this._defaults=g,this._name=f,this._$window=a(b),this._$htmlBody=a("html, body",this.options.context),this._$body=a("body",this.options.context),this._sections=c.length,this._$sections=[],this._sectionIdentifiers=[],this._delayFirstScroll=null,this._$currentSection=null,this._currentStep=0,this._isFirstSection=!0,this._isAnimated=!1,this._wheelDelay=null,this._scrollPaused=!1,this._$nav=null,this._ie8=!1,this.init()}var f="scrollSections",g={attr:"id",active:"active-scrollsection",keyboard:!0,mousewheel:!0,touch:!0,scrollbar:!0,navigation:!0,scrollMax:1,before:null,after:null,prefix:"scrollsections",alwaysStartWithFirstSection:!1,animateScrollToFirstSection:!1,createNavigation:!0,speed:500,exceptions:!1,context:null};e.prototype={createNavigation:function(){if(this.options.navigation){this._$nav=a("<nav>",{id:this.options.prefix+"-navigation"});for(var b=0;b<this._sections;b++)this._$nav.append(a("<a>",{id:this.options.prefix+"-menuitem-"+b,"class":this.options.prefix+"-menuitem",href:"#"+this._sectionIdentifiers[b],html:"Section "+b}));this._$body.append(this._$nav)}return this},navigation:function(){var b=this;return null===this._$nav&&(this.options.createNavigation?(this.createNavigation(),this.options.createNavigation=!1):this._$nav=a("#"+this.options.prefix+"-navigation"),this._$nav._$menuitems=a("a",this._$nav).each(function(c){var d=a(this);c===b._currentStep&&d.addClass(b.options.active),d.data(b.options.prefix,c)})),null!=this._$nav&&this._$nav.length>0&&this._$nav._$menuitems.click(function(c){var d=a(this);return c.preventDefault(),b._$nav._$menuitems.removeClass(b.options.active),d.addClass(b.options.active),b.scrollTo(parseInt(d.data(b.options.prefix),10)),!1}),this},scrollbar:function(){var b=this;if(!a.event.special.scrollstop){if(this.options.exceptions)throw new d("The jQuery special events scrollstop plugin is missing.");return this}return this._$window.bind("scrollstop",function(a){var d,e,f=b._$htmlBody.scrollTop()||b._$window.scrollTop(),g=b._$htmlBody.outerHeight();if(a.preventDefault(),b._scrollPaused=!1,0===f&&0!==b._currentStep)d=0;else if(f===(b._sections-1)*b._$window.height()&&b._currentStep!==b._sections-1)d=b._sections-1;else for(var h=0;h<b._sections;h++)if(e=c.abs(f-b._$sections[h].offset().top),(!g||g>=e)&&(g=e,d=h,0===g))return;return d>-1&&b.scrollTo(d),!1}),this},touch:function(){var a=this;return this._$body.bind("touchstart",function(b){var d=b;return b.preventDefault(),a._$body.bind("touchmove",function(b){var e,f={x:d.clientX-b.clientX,y:d.clientY-b.clientY};return b.preventDefault(),(f.y<=-100||f.y>=100)&&c.abs(f.y)>c.abs(f.x)&&(e=f.y<0?a._currentStep-1:a._currentStep+1,a.scrollTo(e)),!1}),!1}),this},keyboard:function(){var a=this;return this._$htmlBody.keydown(function(b){var c;switch(b.which){case 33:case 36:return b.preventDefault(),a.scrollTo(0),!1;case 34:case 35:return b.preventDefault(),a.scrollTo(a._sections-1),!1;case 38:return b.preventDefault(),c=a._currentStep-1,c>=0&&a.scrollTo(c),!1;case 40:return b.preventDefault(),c=a._currentStep+1,c<a._sections&&a.scrollTo(c),!1}}),this},scrollCallback:function(a){return this._isAnimated=a||!1,a&&this.options.before?this.options.before():this.options.after&&this.options.after(),this},scrollTo:function(b,c){var d,e,f=this;return null!=b&&b>=0&&b<this._sections&&(this._currentStep=b,this._$currentSection=this._$sections[b],d=this._$currentSection.offset().top,e=c?0:this.options.speed,this._$nav&&(this._$nav._$menuitems.removeClass(this.options.active),a("a[href='#"+this._sectionIdentifiers[b]+"']",this._$nav).addClass(this.options.active)),this.scrollCallback(!0)._$htmlBody.stop(!0,!1).animate({scrollTop:d},e,function(){f.scrollCallback()})),this},mousewheelScrollTo:function(a){return this.scrollTo(a),this._wheelDelay=null,this._scrollPaused=!0,this},mousewheel:function(){var b=this;if(this._ie8){if(this.options.exceptions)throw new d("Cannot bind mousewheel on broken client.");return this}if(!a.fn.mousewheel){if(this.options.exceptions)throw new d("The jQuery mousewheel plugin is missing.");return this}return this._$window.mousewheel(function(a,d,e,f){var g=null,h=-1;return a.preventDefault(),b._isAnimated&&b._scrollPaused||(0>f?(f<-b.options.scrollMax&&(f=-b.options.scrollMax),(!h||!g||g>f)&&b._currentStep-f<b._sections&&(g=f,h=b._currentStep-g)):(f>b.options.scrollMax&&(f=b.options.scrollMax),(!h||!g||f>g)&&b._currentStep-f>-1&&(g=f,h=b._currentStep-g)),g&&h>-1&&(b._wheelDelay&&clearTimeout(b._wheelDelay),c.abs(g)<b.options.scrollMax?b._wheelDelay=setTimeout(function(){b.mousewheelScrollTo(h)},10):b.mousewheelScrollTo(h))),!1}),this},init:function(){var c=this;if(this._sections>0){this.elements.each(function(b){var d,e=a(this),f=c._$window.scrollTop();c._$sections[b]=e,c._sectionIdentifiers[b]=e.attr(c.options.attr),c.options.alwaysStartWithFirstSection===!0&&0===b?(e.addClass(c.options.active),c._$currentSection=e,c.scrollTo(0,!c.options.animateScrollToFirstSection)):(d=e.offset(),d.bottom=d.top+e.height(),f>=d.top&&f<d.bottom&&(e.addClass(c.options.active),c._currentStep=b,c._$currentSection=e,f!==d.top&&c.scrollTo(b)))}),new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(b.navigator.userAgent)&&parseFloat(RegExp.$1)<=8&&(this._ie8=!0);for(var d in this.options)this.options[d]===!0&&"function"==typeof this[d]&&this[d]();this._$window.resize(function(){c.scrollTo(c._currentStep)})}return this}},a.fn[f]=function(b){return a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b)),this}}(jQuery,window,Math);